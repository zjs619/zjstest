'use strict'

import jsonFormat from 'json-format'
import jsonminify from 'jsonminify'

import { parseFromCSV, writeFile } from '../common/util'

// Constants:
const T_COMPILE = 'Total compiling time'

const format = (data) => jsonFormat(
  data.map(cleanIconData),
  { type: 'space', size: 2 },
)

const cleanIconData = icon => (
  !!icon.aliases
  ? icon
  : delete icon.aliases && icon
)

console.time(T_COMPILE)

void (async () => {
  const iconData = await parseFromCSV('./fa/icon-list.csv')
  const icon = format(iconData)

  writeFile('./fa/icon-list.json', icon)
  writeFile('./fa/icon-list.min.json', jsonminify(icon))
  console.timeEnd(T_COMPILE)
})()

