'use strict'

import { writeFile } from 'fs'
import csv from 'csvtojson'
import jsonFormat from 'json-format'
import jsonminify from 'jsonminify'

const cleanIconData = icon => (
  icon.hidden === 'true'
    ? Object.assign(icon, { hidden: true })
    : delete icon.hidden && icon
)

csv()
.fromFile('./mb/icon-list.csv')
.on('end_parsed', json => json.map(cleanIconData))
.on('end_parsed', json => writeFile('./mb/icon-list.json', jsonFormat(json, { type: 'space', size: 2 })))
.on('end_parsed', json => writeFile('./mb/icon-list.min.json', JSON.stringify(json)))
